<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="kr.or.ksmart.mapper.AsExchangeMapper">

	<!--a/s접수 코드  -->
  	<select id="getAsReceptionCodeMax" resultType="int">
 		SELECT 
 			IFNULL(MAX(CAST(SUBSTRING(check_code,7) AS DECIMAL)), 0) as maxcol 
		FROM periodic_inspection
		
	
 	</select>
  
  
	<!--a/s 접수 등록  -->
 	<insert id="eInsert" parameterType="kr.or.ksmart.domain.PeriodicInspection">
 	<selectKey keyProperty="checkCode" resultType="String" order="BEFORE">
 			SELECT 
 				CONCAT('check_', MAX(CAST(SUBSTRING(check_code,7) AS DECIMAL)+1)) AS checkCode
			FROM periodic_inspection
		
	
    </selectKey>
	INSERT INTO periodic_inspection  (  check_code
									   ,contract_code
									   ,branch_code
									   ,staff_id 
									   ,check_date 	
									   ,product_status
									   ,check_contents
											
									   ) VALUES(   #{checkCode}	
												 , #{contractCode}
												 , #{branchCode}
												 , #{staffId}
												 , #{checkDate}
												 , #{productStatus}
												 , #{checkContents}
												
												 );
	
	
	</insert> 
	
	






















</mapper>
  