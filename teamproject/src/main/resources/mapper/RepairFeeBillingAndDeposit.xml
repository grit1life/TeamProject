<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  

<mapper namespace="kr.or.ksmart.mapper.RepairFeeBillingAndDepositMapper">  
  
  <!--코드  -->
  	<select id="getrepairFeeBillingAndDepositCodeMax" resultType="int">
 		SELECT 
 			IFNULL(MAX(CAST(SUBSTRING(claim_code,11) AS DECIMAL)), 0) as maxcol 
		FROM repair_fee_billing_and_deposit
		
	
 	</select>
  
  
	<!-- 등록  -->
 	<insert id="rdInsert" parameterType="kr.or.ksmart.domain.RepairFeeBillingAndDeposit">
 	<selectKey keyProperty="claimCode" resultType="String" order="BEFORE">
 			SELECT 
 				CONCAT('claim_code0', MAX(CAST(SUBSTRING(claim_code,15) AS DECIMAL)+1)) AS claimCode
			FROM repair_fee_billing_and_deposit
		
	
    </selectKey>
			INSERT  INTO repair_fee_billing_and_deposit ( claim_code
														 ,repair_code
														 ,contract_code	
														 ,Whether_to_deposit
														 ,claim_date
									 
															
					                 					  ) VALUES( #{claimCode}
										                   			,#{repairCode}
										                   			,#{contractCode}
										                   			,#{WhetherToDeposit}
										                   			,#{claimDate}
										                   				
																  );
												
			
	</insert>
	
</mapper>	