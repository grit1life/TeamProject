<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/default}"
>
<th:block layout:fragment="customTitle">
	<title>staffList.html</title>
</th:block>
<th:block layout:fragment="customTestScript">
<script type="text/javascript">
$(function(){
		
	
	$('.billBtn').click(function(){
			window.open("/staff/billForm?billCode="+$(this).data('set'), "",
			"_blank width=800, height=900, toolbar=no, menubar=no, scrollbars=yes, resizable=no")
		})
}) 
</script>
</th:block> 

<th:block layout:fragment="customContents">
<body class="hold-transition sidebar-mini layout-fixed">
 <div class="content-wrapper">
  
    <section class="content-header"> 
       <div class="row mb-2">
         <div class="col-sm-6">
           <h1>청구서 조회</h1>
         </div>
         <div class="col-sm-6">
           <ol class="breadcrumb float-sm-right">
             <li class="breadcrumb-item"><a href="#">Home</a></li>
             <li class="breadcrumb-item active">Advanced Form</li>
           </ol>
         </div>
       </div>
     </section>
    
  <!-- 견적서 입력 data -->
  <section class="content">
  	<div class="container-fluid">
  		<div class="card card-default">
			 <div class="card-header">
			   <h3 class="card-title">계약 검색</h3>
			
			   <div class="card-tools">
			     <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i></button>
			     <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-remove"></i></button>
			   </div>
			 </div>
			 <div class="card-body">
		         <!-- left -->
		         <form id="contractSerch" action="billSearchList" method="get">
			         <div class="row" >
			           <!-- 1 -->
			           <div class="col-md-6" style="max-width: 25%;">
			             <div class="form-group">
			               <label>고객명</label>
			               <input type="text" class="form-control select2bs4" style="width: 100%;" name="customerName">
			             </div>
			             <!-- /.form-group -->
			             <div class="form-group">
			               <label>직원</label>
			          	   <input type="text" class="form-control select2bs4" list="staffList" style="width: 100%;" name="staffName">
			               <datalist id="staffList">
			               		<option th:each="l : ${staffList}" th:value="${l.staffName}"></option>
			               </datalist>
			             </div>
			           </div>
			           <!-- 2 -->
			           <div class="col-md-6" style="max-width: 25%;">
			              <div class="form-group">
				               <label>전화</label>
				          <input type="text" class="form-control select2bs4" name="customerCall">
				          </div>
			             <div class="form-group">
			               <label>세트명</label>
			               <input type="text" class="form-control select2bs4" list="setList" name="setName">
			               <datalist id="setList">
			               		<option th:each="l : ${setList}" th:value="${l.setName}"></option>
			               </datalist>
			             </div>
			           </div>
			           <!-- 3 -->
			           <div class="col-md-6" style="max-width: 25%;">
			             <!-- /.form-group -->
			             <div class="form-group">
			               <label>렌탈시작일</label>
				         	<input type="date" class="form-control select2bs4" name="rentalFromDate">
				         </div>
			             <div class="form-group">
			               <label>제품명</label>
			               <input type="text" class="form-control select2bs4" list="goodsName" name="goodsName">
			               <datalist id="goodsName">
			               		<option th:each="l : ${goodsList}" th:value="${l.goodsName}"></option>
			               </datalist>
			             </div>
			           </div>
			           <!-- 4 -->
			           <div class="col-md-6" style="max-width: 25%;">
			             <!-- /.form-group -->
			             <div class="form-group">
			               <label>렌탈종료일</label>
			               <input type="date" class="form-control select2bs4" name="rentalToDate">
			             </div>
			             <div class="form-group" style="position: absolute;bottom: 0;">
			               <button id="SerchBtn" type="submit" class="btn btn-info">검색</button>
			             </div>
			             <!-- /.form-group -->
			           </div>
			           <!-- /.col -->
			         </div>
		         </form>
		            <!-- /.row -->
		      </div>
			 </div>
			 
	 <div class="card">
	  <div class="card-body">
	  	<table id="contractTable" class="table table-bordered table-hover"  style="margin-top: 22px;">
	    	<thead>
                <tr>
                  <th style="width: 10px;"></th>
                  <th>고객명</th>
                  <th>상품명(세트)</th>
                  <th>렌탈시작일</th>
                  <th>렌탈종료일</th>
                  <th>전화번호</th>
                  <th>청구회차</th>
                  <th>청구금액</th>
                  <th>총금액</th>
                  <th>담당자</th>
                  <th style="width:100px">청구서</th>
                  <th style="width:85px">삭제</th>
                </tr>
	         </thead>
             <tbody>
             <tr th:each="l, i : ${list}">
                <td th:text="${i.count}"></td>
                <td th:if="${l.customerCompanyName}!=null" th:text="${l.customerCompanyName+'(법인)'}"></td>
                <td th:if="${l.customerCompanyName}==null" th:text="${l.customerName}"></td>
	         	<!--    상품 or 세트, 외  몇 건 -->
	            <th:block th:if="${l.count>1}">
	                <td th:if="${l.goodsName}!=null" th:text="${l.goodsName+'&nbsp;외 '+(l.count-1)+'품목'}"></td>
	                <td th:if="${l.goodsName}==null" th:text="${l.setName+'&nbsp;외 '+(l.count-1)+'품목'}"></td>
               	</th:block>
	            <th:block th:if="${l.count==1}">
	                <td th:if="${l.goodsName}!=null" th:text="${l.goodsName}"></td>
	                <td th:if="${l.goodsName}==null" th:text="${l.setName}"></td>
               	</th:block>
               	<!-- 상품 or 세트, 외  몇 건 끝 -->
               	<td th:text="${l.rentalFromDate}"></td>
               	<td th:text="${l.rentalToDate}"></td>
               	<td th:text="${l.customerCall}"></td>
               	<td th:text="${l.billPayNumber}"></td>
               	<td th:text="${#numbers.formatInteger(l.payMonth, 0,'COMMA')}"></td>
                <td th:text="${#numbers.formatInteger(l.total, 0,'COMMA')}"></td>
                <td th:text="${l.staffName}"></td>
                <td>
	               	<a class="billBtn btn btn-success btn-sm" th:data-set="${l.billCode}" href="#" style="padding:1px 4px 1px 4px">
	                    <svg class="bi bi-folder-fill" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
						  <path fill-rule="evenodd" d="M9.828 3h3.982a2 2 0 011.992 2.181l-.637 7A2 2 0 0113.174 14H2.826a2 2 0 01-1.991-1.819l-.637-7a1.99 1.99 0 01.342-1.31L.5 3a2 2 0 012-2h3.672a2 2 0 011.414.586l.828.828A2 2 0 009.828 3zm-8.322.12C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707A1 1 0 006.172 2H2.5a1 1 0 00-1 .981l.006.139z" clip-rule="evenodd"/>
						</svg>&ensp;청구서
					</a>
                </td>
                <td>
                	<a class="btn btn-danger btn-sm" href="#" style="padding:1px 4px 1px 4px">
                    <i class="fas fa-trash"></i>&ensp;삭제</a>
                </td>
              </tr>
             </tbody>
		</table>
		<br>
		<!-- 페이징 -->
	   <nav aria-label="Page navigation example">
		  <ul class="pagination">
		    <li class="page-item">
			    <th:block th:if="${currentPage>1}">
			      <a class="page-link" th:href="@{/staff/billSearchList(page=${currentPage-1},customerName=${docBill.customerName},staffName=${docBill.staffName},customerCall=${docBill.customerCall},setName=${docBill.setName},rentalFromDate=${docBill.rentalFromDate},goodsName=${docBill.goodsName},rentalToDate=${docBill.rentalToDate})}" aria-label="Previous">
			        <span aria-hidden="true">&laquo;</span>
			      </a>
				</th:block>
				<th:block th:unless="${currentPage>1}">
			      <a class="page-link" aria-label="Previous">
			        <span aria-hidden="true">&laquo;</span>
			      </a>
				</th:block>
		    </li>
			<th:block th:each="num : ${#numbers.sequence(startPage, endPage)}">
		    	<li class="page-item"><a class="page-link" th:text="${num}" th:href="@{/staff/billSearchList(page=${num},customerName=${docBill.customerName},staffName=${docBill.staffName},customerCall=${docBill.customerCall},setName=${docBill.setName},rentalFromDate=${docBill.rentalFromDate},goodsName=${docBill.goodsName},rentalToDate=${docBill.rentalToDate})}"></a></li>
			</th:block>
		    <li class="page-item">
		    	<th:block th:if="${endPage>currentPage}">
			      <a class="page-link" th:href="@{/staff/billSearchList(page=${currentPage+1},customerName=${docBill.customerName},staffName=${docBill.staffName},customerCall=${docBill.customerCall},setName=${docBill.setName},rentalFromDate=${docBill.rentalFromDate},goodsName=${docBill.goodsName},rentalToDate=${docBill.rentalToDate})}" aria-label="Next">
			        <span aria-hidden="true">&raquo;</span>
			      </a>
			    </th:block>
			    <th:block th:unless="${endPage>currentPage}">
			      <a class="page-link" aria-label="Next">
			        <span aria-hidden="true">&raquo;</span>
			      </a>
			    </th:block>
		    </li>
		  </ul>
		</nav>
             <!-- 페이징 끝 -->

	  </div>
	 </div>   	    
	</div>
  </section>
</div>
</body>
</th:block>
</html>